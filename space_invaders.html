<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Space Invaders Evolution</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }
    header {
      text-align: center;
      padding: 5px;
      font-size: 1.2em;
      font-weight: bold;
      background: #111;
    }
    #gameWrapper {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      background: rgb(39, 36, 39);
    }
    canvas {
      background: #000;
      display: block;
    }
    #overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      text-align: center;
    }
    #overlay h1 {
      font-size: 2.5em;
      margin-bottom: 15px;
      animation: glow 2s infinite alternate;
    }
    @keyframes glow {
      from { text-shadow: 0 0 10px #0f0, 0 0 20px #0f0; }
      to { text-shadow: 0 0 20px #0f0, 0 0 40px #0f0; }
    }
    button {
      background: #0f0;
      border: none;
      padding: 8px 16px;
      font-size: 1em;
      cursor: pointer;
      border-radius: 6px;
      margin: 5px;
    }
    #pauseOverlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      font-weight: bold;
      z-index: 9;
    }
    footer {
      text-align: center;
      padding: 10px;
      font-size: 0.9em;
      background: #111;
    }
  </style>
</head>
<body>
  <header>
    Space Invaders ‚Äì Pontos: <span id="score">0</span> | 
    Fase: <span id="level">1</span> | 
    Vidas: <span id="lives">3</span> | 
    Recorde: <span id="highscore">0</span>
    <button id="musicBtn">üéµ M√∫sica</button>
    <button id="fsBtn">‚õ∂ Tela Cheia</button>
    <button onclick="window.location.href='index.html'">üè† Voltar</button>
  </header>

  <div id="gameWrapper">
    <canvas id="gameCanvas" width="500" height="500"></canvas>

    <div id="overlay">
      <h1>üëæ Space Invaders</h1>
      <button id="startBtn">‚ñ∂ Iniciar Jogo</button>
    </div>
    <div id="pauseOverlay">‚è∏Ô∏è Jogo Pausado</div>
  </div>

  <footer>
    <p>¬© 2025 Games On-Line. Todos os direitos reservados.</p>
  </footer>

 <!-- Sons -->
  <audio id="shootSound" src="https://actions.google.com/sounds/v1/foley/metal_bar_twirl.ogg"></audio>
  <audio id="dieSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
  <audio id="bgMusic" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" loop></audio>

  <script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const overlay = document.getElementById("overlay");
const startBtn = document.getElementById("startBtn");

const scoreEl = document.getElementById("score");
const highscoreEl = document.getElementById("highscore");
const levelEl = document.getElementById("level");
const livesEl = document.getElementById("lives");

const musicBtn = document.getElementById("musicBtn");
const fsBtn = document.getElementById("fsBtn");

const shootSound = document.getElementById("shootSound");
const dieSound = document.getElementById("dieSound");
const bgMusic = document.getElementById("bgMusic");

let player, bullets, enemies, enemyBullets;
let score = 0, highscore = 0, level = 1, lives = 3;
let gameInterval, enemyShootInterval;

// üîπ Ajusta o tamanho do canvas conforme a tela
function resizeCanvas() {
  canvas.width = Math.min(window.innerWidth, 800);
  canvas.height = Math.min(window.innerHeight - 120, 600);
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function initGame() {
  player = { x: canvas.width/2 - 20, y: canvas.height - 50, width: 40, height: 20, speed: 6 };
  bullets = [];
  enemies = [];
  enemyBullets = [];
  spawnEnemies();
  updateHUD();
}

function spawnEnemies() {
  enemies = [];
  enemyBullets = [];
  let rows = 2 + Math.floor(level/2);
  let cols = 6 + Math.floor(level/3);
  let spacing = Math.min(50, canvas.width / (cols + 1));
  for (let r=0; r<rows; r++) {
    for (let c=0; c<cols; c++) {
      enemies.push({
        x: 40 + c*spacing,
        y: 40 + r*spacing,
        width: 28, height: 20,
        dx: Math.random() < 0.5 ? 1 : -1,
        dy: 0.2 + Math.random()*0.3,
        life: 1
      });
    }
  }
  if (level % 5 === 0) {
    let bossLife = 20 * (level / 5);
    enemies.push({ 
      x: canvas.width/2 - 50, 
      y: 60, 
      width: 100, height: 60, boss: true, 
      dx: 2, dy: 0.5, life: bossLife
    });
  }
}

function updateHUD() {
  scoreEl.textContent = score;
  highscoreEl.textContent = highscore;
  levelEl.textContent = level;
  livesEl.textContent = lives;
}

function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Jogador
  ctx.fillStyle = "lime";
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Balas do jogador
  bullets.forEach((b,i)=>{
    b.y -= 6;
    ctx.fillStyle = "white";
    ctx.fillRect(b.x, b.y, 4, 10);
    if (b.y < 0) bullets.splice(i,1);
  });

  // Inimigos
  enemies.forEach((e,i)=>{
    e.x += e.dx;
    e.y += e.dy * 0.3;
    if (e.x < 0 || e.x + e.width > canvas.width) e.dx *= -1;
    ctx.fillStyle = e.boss ? "red" : "yellow";
    ctx.fillRect(e.x, e.y, e.width, e.height);
    if (checkCollision(player, e)) playerHit();
  });

  // Balas inimigas
  enemyBullets.forEach((b,i)=>{
    b.y += 4;
    ctx.fillStyle = "red";
    ctx.fillRect(b.x,b.y,4,10);
    if (b.y > canvas.height) enemyBullets.splice(i,1);
    if (checkCollision(player, b)) {
      enemyBullets.splice(i,1);
      playerHit();
    }
  });

  // Colis√£o balas do player
  bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      if (checkCollision(b,e)) {
        bullets.splice(bi,1);
        e.life--;
        if (e.life <= 0) {
          enemies.splice(ei,1);
          score += e.boss ? 50 : 10;
          if (score > highscore) highscore = score;
        }
      }
    });
  });

  if (enemies.length === 0) nextLevel();
  updateHUD();
}

function nextLevel() {
  level++;
  if (level > 25) {
    overlay.innerHTML = `<h1>üéâ Voc√™ Venceu!</h1>
    <p>Pontua√ß√£o: ${score}</p>
    <button onclick="restart()">‚ñ∂ Jogar Novamente</button>`;
    overlay.style.display = "flex";
    clearInterval(gameInterval);
    clearInterval(enemyShootInterval);
    return;
  }
  spawnEnemies();
}

function checkCollision(a,b) {
  return (a.x < b.x+b.width && a.x+a.width > b.x && a.y < b.y+b.height && a.y+a.height > b.y);
}

function playerHit() {
  lives--;
  updateHUD();
  if (lives <= 0) {
    dieSound.play();
    overlay.innerHTML = `<h1>üíÄ Game Over</h1>
    <p>Pontua√ß√£o: ${score}</p>
    <button onclick="restart()">üîÑ Reiniciar</button>`;
    overlay.style.display = "flex";
    clearInterval(gameInterval);
    clearInterval(enemyShootInterval);
  }
}

function restart() {
  score = 0;
  level = 1;
  lives = 3;
  overlay.style.display = "none";
  initGame();
  gameInterval = setInterval(update, 30);
  enemyShootInterval = setInterval(enemyShoot, 800);
}

function enemyShoot() {
  if (enemies.length > 0) {
    let shooters = Math.min(5, enemies.length);
    for (let i = 0; i < shooters; i++) {
      let e = enemies[Math.floor(Math.random()*enemies.length)];
      enemyBullets.push({x: e.x+e.width/2, y: e.y+e.height, width:4, height:10});
    }
  }
}

// Controles de teclado
let keys = {};
document.addEventListener("keydown", e => { keys[e.key] = true; });
document.addEventListener("keyup", e => { keys[e.key] = false; });

function handlePlayerMovement() {
  if (keys["ArrowLeft"] && player.x > 0) player.x -= player.speed;
  if (keys["ArrowRight"] && player.x + player.width < canvas.width) player.x += player.speed;
  if (keys[" "]) {
    if (!keys.shooting) {
      bullets.push({x: player.x+player.width/2-2, y: player.y, width:4, height:10});
      shootSound.play();
      keys.shooting = true;
    }
  } else {
    keys.shooting = false;
  }
}
setInterval(handlePlayerMovement, 20);

// Bot√µes de interface
startBtn.onclick = () => {
  overlay.style.display = "none";
  initGame();
  gameInterval = setInterval(update, 30);
  enemyShootInterval = setInterval(enemyShoot, 800);
  bgMusic.play();
};

musicBtn.onclick = () => {
  if (bgMusic.paused) bgMusic.play(); else bgMusic.pause();
};

fsBtn.onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

// üîπ Controles de toque (mobile)
const touchControls = document.createElement("div");
touchControls.innerHTML = `
  <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:20px;z-index:10;">
    <button id="leftBtn">‚¨Ö</button>
    <button id="shootBtn">üî•</button>
    <button id="rightBtn">‚û°</button>
  </div>
`;
document.body.appendChild(touchControls);

document.getElementById("leftBtn").addEventListener("touchstart",()=>keys["ArrowLeft"]=true);
document.getElementById("leftBtn").addEventListener("touchend",()=>keys["ArrowLeft"]=false);
document.getElementById("rightBtn").addEventListener("touchstart",()=>keys["ArrowRight"]=true);
document.getElementById("rightBtn").addEventListener("touchend",()=>keys["ArrowRight"]=false);
document.getElementById("shootBtn").addEventListener("touchstart",()=>{
  bullets.push({x: player.x+player.width/2-2, y: player.y, width:4, height:10});
  shootSound.play();
});
</script>


</body>
</html>
